<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Kávový stánek — MVP prototyp (vanilla JS)</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
<div id="app">
  <div class="topbar">
    <!-- Left metrics -->
    <div class="metrics" id="metrics-left">
      <div class="metric">Čas: <span id="time">00:00</span></div>
      <div class="metric">Fronta: <span id="queueTop">0</span></div>
    </div>

    <!-- Dialog choices (center) -->
    <div class="dialog-choices">
      <button class="good" id="btnGreeting">Dobrý den! Co si dáte?</button>
      <button class="good" id="btnConfirm">Potvrdím objednávku</button>
      <button class="bad" id="btnBad">Nevhodná replika</button>
    </div>

    <!-- Right metrics -->
    <div class="metrics" style="justify-content:flex-end">
      <div class="metric">Pokladna: <strong id="bank">0 Kč</strong></div>
      <div class="metric">Odbaveno: <span id="served">0</span></div>
      <div class="metric">Reputace: <span id="reputation">0.0</span></div>
      <div class="metric" style="min-width:160px">Spokojenost
        <div class="sbar" title="Spokojenost zákazníka (0–100)"><span id="sbar" style="width:50%"></span></div>
      </div>
    </div>
  </div>

  <main>
    <section class="panel queue">
      <div style="display:flex; justify-content:space-between; align-items:center">
        <h3 style="margin:0">Fronta</h3>
        <div class="metric" title="Max 4 viditelné hlavy">Ve frontě: <span id="queueCount">0</span></div>
      </div>
      <div class="queue-list" id="queueHeads"></div>
      <div style="padding-top:6px; font-size: 13px; color: var(--muted)">Aktivní zákazník stojí vlevo (objednávka), po potvrzení přejde doprava (platba).</div>
    </section>

    <section class="panel stage">
      <div style="display:flex; justify-content:space-between; align-items:center">
        <h3 style="margin:0">Příprava</h3>
        <div class="metric">Ceník: Káva S/M/L — 39/49/59 Kč</div>
      </div>
      <div class="customer-viewport">
        <div class="cust-bubble" id="bubble">
          <div>Objednávka: <span class="items" id="orderLabel">—</span></div>
          <div style="font-size:12px; color:var(--muted)">Fáze: <span id="phase">—</span></div>
        </div>
      </div>
      <div class="current-item" id="currentItemPanel">
        <strong>Aktuální položka:</strong>
        <span class="pill" id="curItemLabel">—</span>
        <span class="pill" id="curItemIngredients">—</span>
      </div>
      <div class="workbench">
        <button id="btnSizeS">Kelímek S</button>
        <button id="btnSizeM">Kelímek M</button>
        <button id="btnSizeL">Kelímek L</button>
        <button class="danger" id="btnTrash">Koš</button>

        <button class="primary" id="btnPot">Konvice: dávka kávy</button>
        <button id="btnFinalize">Dokončit položku (tap na kelímek)</button><button id="btnToggleDev" title="Zobrazit skrytou konzoli (D)">Dev konzole</button>
      </div>
    </section>

    <section class="panel orderpanel">
      <h3 style="margin:0 0 6px 0">Pravý pult (výdej)</h3>
      <div style="display:grid; grid-template-columns: 1fr 1fr; gap: 8px">
        <div>
          <div style="font-weight:700">Objednáno</div>
          <div class="list" id="orderedList"></div>
        </div>
        <div>
          <div style="font-weight:700">Připraveno</div>
          <div class="list" id="preparedList"></div>
        </div>
      </div>
      <div style="margin-top:8px; font-size:12px; color:var(--muted)">Platbu odemkneme až když se seznamy shodují.</div>
      <div class="payment" id="paymentPanel">
        <div class="pay-row">
          <input id="payInputInline" inputmode="numeric" pattern="[0-9]*" placeholder="Částka v Kč" />
          <button class="primary" id="btnPayConfirmInline">Potvrdit</button>
        </div>
        <div class="keypad" id="keypadInline"></div>
        <div class="pay-error" id="payErrorInline">Nesprávná částka.</div>
      </div>
    </section>
  </main>

  <div class="bottombar">
    <div class="section"><h4>Ovládání:</h4>
      <span class="kbd">Klik</span> na ingredience a kelímky, <span class="kbd">Koš</span> smaže rozpracovanou položku, <span class="kbd">Platbu zadáváš vpravo, pole je stále aktivní (součet se nikde nezobrazuje).
    </div>
  </div>
</div>

<!-- Overlay Report / Game Over -->
<div class="overlay" id="reportOverlay">
  <div class="report">
    <h2 style="margin-top:0" id="reportTitle">Směna skončila</h2>
    <div id="reportBody"></div>
    <div style="display:flex; gap:8px; justify-content:flex-end; margin-top:12px">
      <button id="btnRestart">Restart</button>
    </div>
  </div>
  </div>

<!-- Dev console -->
<div class="dev" id="dev">
  <div style="margin-bottom:6px">Konzole (toggle <span class="kbd">D</span>) — runtime stav a log</div>
  <div class="grid">
    <table>
      <thead><tr><th colspan="2">Game/Shift</th></tr></thead>
      <tbody id="tblGame"></tbody>
    </table>
    <table>
      <thead><tr><th colspan="2">Customer</th></tr></thead>
      <tbody id="tblCust"></tbody>
    </table>
    <table>
      <thead><tr><th colspan="2">Order/Recipe</th></tr></thead>
      <tbody id="tblOrder"></tbody>
    </table>
    <table>
      <thead><tr><th colspan="2">Economy</th></tr></thead>
      <tbody id="tblEco"></tbody>
    </table>
  </div>
  <div class="log" id="eventLog"></div>
</div>

<!-- Offline bundle: built via esbuild to avoid file:// CORS -->
<script src="app.bundle.js"></script>
</body>
</html>
